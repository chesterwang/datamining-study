

----------------------总的训练,总的预测--------------------------

[[  36702.     519.   48796.      29.     263.       0.       0.       0.      0.       0.]
 [  17259.    9517.    8011.    3801.   19887.       0.       2.     117.      0.       0.]
 [  15948.    2138.   42997.    1874.    8416.       0.       8.       2.      1.       0.]
 [  12602.     242.    3423.   40839.    1604.       5.    5087.     199.      15.      85.]
 [   1328.    4216.   22245.   19071.  121028.    2705.     698.     457.      7.      12.]
 [    604.      35.     177.     676.     467.     566.     548.     280.      102.      81.]
 [    487.     118.      87.     763.    1362.      98.    9378.    2091.      24.      64.]
 [    503.     453.     141.    1055.     137.       0.     813.   22788.      1726.      31.]
 [     15.     109.      77.     552.     222.       3.     539.    1897.      2401.      21.]
 [      0.     127.      12.     107.     699.     137.     576.     708.      759.    1834.]]
auc evaluation
0.683176011335





----------------------总的训练,分开预测--------------------------


  13701 adiquity
 186605 axonix
 199734 doubleclick
  26223 inmobi
 326999 nexage
 662272 smaato
 211446 tapsense
   2461 youku

价格档位
tmp_class_dict = {"1":(0,0.05),
    "2":(0.05,0.10),
    "3":(0.10,0.15),
    "4":(0.15,0.20),
    "5":(0.20,0.25),
    "6":(0.25,0.30),
    "7":(0.30,0.35),
    "8":(0.35,0.40),
    "9":(0.40,0.45),
    "10":(0.45,0.50),}

价格众数

>for adx in "adiquity" "axonix" "doubleclick" "inmobi" "nexage" "smaato" "tapsense";do echo $adx;awk -F'[:|]' '{print $(NF-2)}' join_log_april_1_${adx} | sort | uniq -c | sort -nr | head -n10;done
adiquity
   5289 0.0900
   1469 0.1100
     82 0.1696
      9 0.0905
      8 0.1540
      4 0.2159
      4 0.0906
      3 0.1361
      2 0.1871
      2 0.1707
axonix
  23435 0.5900
  14148 0.3896
   8146 0.3100
   6569 0.2400
   4325 0.1900
   3041 0.3504
   2740 0.6375
   1687 0.6100
   1524 0.3898
   1363 0.4690
doubleclick
  11904 0.0160
   5135 0.1890
   4044 0.1510
   3757 0.1260
   2335 0.1390
   1810 0.0210
   1737 0.0310
   1453 0.0890
   1357 0.0810
   1271 0.1480
inmobi
   3440 0.1600
   2352 0.1612
    914 0.1100
    673 0.3826
    627 0.1300
    452 0.4190
    429 0.1463
    349 0.1454
    275 0.2427
    262 0.3449
nexage
  62526 1.0100
  38279 0.6100
  16967 0.6400
  13705 0.5100
  13648 0.6900
   3657 0.1575
   2045 0.3300
   1912 0.1995
    928 1.0491
    925 0.7100
smaato
  25731 0.2418
  14393 0.2421
  13286 0.2415
   8569 0.2119
   8453 0.2178
   8149 0.6250
   8127 0.0191
   7791 0.1636
   6526 0.0397
   5776 0.1037
tapsense
   2203 7.3000
   2151 7.4800
   2142 7.4200
   2088 7.6600
   2042 7.7800
   2032 7.6000
   1994 7.3600
   1966 7.7200
   1950 7.5400
   1626 7.8400



- adiquity
confusion matrix
[[    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.  5305.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.  1399.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.    97.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.    12.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]]
auc evaluation
0.288962932931
- axonix
confusion matrix
[[     0.      0.      0.      0.      0.      0.      0.      0.      0.  0.]
 [     0.      0.      0.      0.      0.      0.      0.      0.      0.  0.]
 [     0.      0.      0.      1.      0.      0.      8.      2.      1.  0.]
 [     0.      0.      0.    233.    767.      5.   5083.    199.     15.  85.]
 [     0.      0.      0.     13.   6674.     67.    698.    457.      7.  11.]
 [     0.      0.      0.      4.    163.    345.    548.    280.    102.  81.]
 [     0.      0.      0.     21.   1059.     98.   7297.   2091.     24.  64.]
 [     0.      0.      0.      1.    131.      0.    803.  22018.   1726.  31.]
 [     0.      0.      0.      6.    198.      3.    523.   1872.   2071.  21.]
 [     0.      0.      0.      0.    694.    137.    563.    681.    753.  1070.]]
auc evaluation
0.632189281193
- doubleclick
confusion matrix
[[ 31795.      0.     15.      1.      0.      0.      0.      0.      0.  0.]
 [ 16235.      0.     74.    395.      0.      0.      0.      0.      0.  0.]
 [ 15947.      0.   6453.    833.      0.      0.      0.      0.      0.  0.]
 [ 12602.      0.   2180.  10078.      0.      0.      0.      0.      0.  0.]
 [   623.      0.    170.    203.      0.      0.      0.      0.      0.  0.]
 [   594.      0.    126.    121.      0.      0.      0.      0.      0.  0.]
 [   487.      0.     55.    129.      0.      0.      0.      0.      0.  0.]
 [   503.      0.     56.    170.      0.      0.      0.      0.      0.  0.]
 [    15.      0.      0.      7.      0.      0.      0.      0.      0.  0.]
 [     0.      0.      0.      0.      0.      0.      0.      0.      0.  0.]]
auc evaluation
0.764692029941
- inmobi
confusion matrix
[[    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.   207.    21.     0.     0.     0.     0.     0.     0.     0.]
 [    0.    38.  3011.   266.     0.     0.     0.     0.     0.     0.]
 [    0.     8.   346.  5861.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     2.   580.     0.     0.     0.     0.     0.     0.]
 [    0.     1.     4.   431.     0.     0.     0.     0.     0.     0.]
 [    0.    37.    16.   573.     0.     0.     0.     0.     0.     0.]
 [    0.    56.     3.   859.     0.     0.     0.     0.     0.     0.]
 [    0.     4.     2.   501.     0.     0.     0.     0.     0.     0.]
 [    0.     8.     2.    91.     0.     0.     0.     0.     0.     0.]]
auc evaluation
0.76583260589
- nexage
confusion matrix
[[    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.   272.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.    38.  6411.     0.     0.     4.     0.     0.     0.]
 [    0.     0.    36.    36.   470.     0.     0.     0.     0.     1.]
 [    0.     0.    43.    43.    18.     0.     0.     0.     0.     0.]
 [    0.     0.    15.    40.    11.     0.  2046.     0.     0.     0.]
 [    0.     0.    81.    25.     6.     0.    10.   267.     0.     0.]
 [    0.     0.    75.    31.    10.     0.    16.    25.   130.     0.]
 [    0.     0.    10.    15.     3.     0.    13.    27.     6.   748.]]
auc evaluation
0.273699749586
- smaato
confusion matrix
[[  3628.    347.    544.     12.     56.      0.      0.      0.      0.  0.]
 [   129.   3142.    950.   3059.   2206.      0.      2.    117.      0.  0.]
 [     1.   1644.  13992.    230.   3634.      0.      0.      0.      0.  0.]
 [     0.    209.    139.  16399.    231.      0.      0.      0.      0.  0.]
 [    51.   4015.  16264.    182.  24890.   2229.      0.      0.      0.  0.]
 [    10.     34.      1.     77.     52.     41.      0.      0.      0.  0.]
 [     0.     81.      0.      0.      2.      0.     35.      0.      0.  0.]
 [     0.    397.      1.      0.      0.      0.      0.    503.      0.  0.]
 [     0.    105.      0.      7.     14.      0.      0.      0.    200.  0.]
 [     0.    119.      0.      1.      2.      0.      0.      0.      0.  16.]]
auc evaluation
0.610723548644




----------------------分开训练,分开预测--------------------------






-00000000000000000000 adiquity
impression:6888
confusion matrix
[[    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.  5305.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.  1399.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.    97.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.    12.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]]
auc evaluation
0.371388491806
-00000000000000000000 axonix
impression:93199
confusion matrix
[[     0.      0.      0.      0.      0.      0.      0.      0.      0.  0.]
 [     0.      0.      0.      0.      0.      0.      0.      0.      0.  0.]
 [     0.      0.      0.      0.      4.      0.      6.      2.      0.  0.]
 [     0.      0.      0.     23.   2172.    122.   3857.    207.      0.  6.]
 [     0.      0.      0.      2.   6738.    173.    558.    450.      2.  4.]
 [     0.      0.      0.      0.    183.    690.    292.    314.     29.  15.]
 [     0.      0.      0.      0.   1378.    183.   6986.   2093.      6.  8.]
 [     0.      0.      0.      0.    146.      0.    803.  22599.   1146.  16.]
 [     0.      0.      0.      3.    230.     29.    509.   2181.   1733.  9.]
 [     0.      0.      0.      0.    706.    149.    572.    782.    643.  1046.]]
auc evaluation
0.643722784767
-00000000000000000000 doubleclick
impression:99867
confusion matrix
[[ 31796.      0.     14.      1.      0.      0.      0.      0.      0.  0.]
 [ 16235.      1.     88.    380.      0.      0.      0.      0.      0.  0.]
 [ 15973.      0.   6460.    800.      0.      0.      0.      0.      0.  0.]
 [ 12605.      0.   2197.  10058.      0.      0.      0.      0.      0.  0.]
 [   624.      0.    173.    199.      0.      0.      0.      0.      0.  0.]
 [   594.      0.    127.    120.      0.      0.      0.      0.      0.  0.]
 [   493.      0.     54.    124.      0.      0.      0.      0.      0.  0.]
 [   513.      0.     55.    161.      0.      0.      0.      0.      0.  0.]
 [    15.      0.      0.      7.      0.      0.      0.      0.      0.  0.]
 [     0.      0.      0.      0.      0.      0.      0.      0.      0.  0.]]
auc evaluation
0.765644153328
-00000000000000000000 inmobi
impression:13112
confusion matrix
[[    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.   207.    21.     0.     0.     0.     0.     0.     0.     0.]
 [    0.    40.  2996.   279.     0.     0.     0.     0.     0.     0.]
 [    0.     8.   353.  5854.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     2.   580.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     3.   433.     0.     0.     0.     0.     0.     0.]
 [    0.     8.    15.   603.     0.     0.     0.     0.     0.     0.]
 [    0.     6.     3.   909.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     2.   505.     0.     0.     0.     0.     0.     0.]
 [    0.     1.     2.    98.     0.     0.     0.     0.     0.     0.]]
auc evaluation
0.773333321274
-00000000000000000000 nexage
impression:163407
confusion matrix
[[    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.   192.     0.     0.     0.     0.    73.     7.     0.]
 [    0.     0.    31.  6410.     0.     0.     4.     8.     0.     0.]
 [    0.     0.    24.    35.   470.     0.     0.    11.     3.     0.]
 [    0.     0.    37.    42.    18.     0.     0.     6.     1.     0.]
 [    0.     0.    14.    40.    11.     0.  2045.     1.     1.     0.]
 [    0.     0.    46.    25.     6.     0.    10.   299.     3.     0.]
 [    0.     0.    59.    31.    10.     0.    16.    37.   134.     0.]
 [    0.     0.     6.    15.     3.     0.    13.    31.     6.   748.]]
auc evaluation
0.328503694905
-00000000000000000000 smaato
impression:331445
confusion matrix
[[  3433.    522.    269.    310.     53.      0.      0.      0.      0.  0.]
 [   104.   3087.    797.   3431.   2130.      0.      3.     53.      0.  0.]
 [     0.   1687.  12657.   1850.   3307.      0.      0.      0.      0.  0.]
 [     0.    160.    137.  16469.    212.      0.      0.      0.      0.  0.]
 [    15.   3725.  15942.    940.  24780.   2229.      0.      0.      0.  0.]
 [    10.     33.      1.     78.     52.     41.      0.      0.      0.  0.]
 [     0.     69.      0.      0.      7.      0.     42.      0.      0.  0.]
 [     0.    683.      0.      0.      0.      0.      0.    218.      0.  0.]
 [     0.    106.      0.      7.     14.      0.      0.      0.    199.  0.]
 [     0.    110.      0.     10.      2.      0.      0.      0.      0.  16.]]
auc evaluation
0.626324955089
-00000000000000000000 tapsense
impression:105573
confusion matrix
[[ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]]
auc evaluation





-00000000000000000000 adiquity
confusion matrix
[[    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.  5305.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.  1399.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.    97.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.    12.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]]
auc evaluation
0.371388491806
-00000000000000000000 axonix
confusion matrix
[[     0.      0.      0.      0.      0.      0.      0.      0.      0.     0.]
 [     0.      0.      0.      0.      0.      0.      0.      0.      0.     0.]
 [     0.      0.      0.      0.      4.      0.      6.      2.      0.     0.]
 [     0.      0.      0.     23.   2172.    122.   3857.    207.      0.     6.]
 [     0.      0.      0.      2.   6738.    173.    558.    450.      2.     4.]
 [     0.      0.      0.      0.    183.    690.    292.    314.     29.     15.]
 [     0.      0.      0.      0.   1378.    183.   6986.   2093.      6.     8.]
 [     0.      0.      0.      0.    146.      0.    803.  22599.   1146.     16.]
 [     0.      0.      0.      3.    230.     29.    509.   2181.   1733.     9.]
 [     0.      0.      0.      0.    706.    149.    572.    782.    643.     1046.]]
auc evaluation
0.643722784767
-00000000000000000000 doubleclick
confusion matrix
[[ 31796.      0.     14.      1.      0.      0.      0.      0.      0.     0.]
 [ 16235.      1.     88.    380.      0.      0.      0.      0.      0.     0.]
 [ 15973.      0.   6460.    800.      0.      0.      0.      0.      0.     0.]
 [ 12605.      0.   2197.  10058.      0.      0.      0.      0.      0.     0.]
 [   624.      0.    173.    199.      0.      0.      0.      0.      0.     0.]
 [   594.      0.    127.    120.      0.      0.      0.      0.      0.     0.]
 [   493.      0.     54.    124.      0.      0.      0.      0.      0.     0.]
 [   513.      0.     55.    161.      0.      0.      0.      0.      0.     0.]
 [    15.      0.      0.      7.      0.      0.      0.      0.      0.     0.]
 [     0.      0.      0.      0.      0.      0.      0.      0.      0.     0.]]
auc evaluation
0.765644153328
-00000000000000000000 inmobi
confusion matrix
[[    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.   207.    21.     0.     0.     0.     0.     0.     0.     0.]
 [    0.    40.  2996.   279.     0.     0.     0.     0.     0.     0.]
 [    0.     8.   353.  5854.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     2.   580.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     3.   433.     0.     0.     0.     0.     0.     0.]
 [    0.     8.    15.   603.     0.     0.     0.     0.     0.     0.]
 [    0.     6.     3.   909.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     2.   505.     0.     0.     0.     0.     0.     0.]
 [    0.     1.     2.    98.     0.     0.     0.     0.     0.     0.]]
auc evaluation
0.773333321274
-00000000000000000000 nexage
confusion matrix
[[    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.]
 [    0.     0.   192.     0.     0.     0.     0.    73.     7.     0.]
 [    0.     0.    31.  6410.     0.     0.     4.     8.     0.     0.]
 [    0.     0.    24.    35.   470.     0.     0.    11.     3.     0.]
 [    0.     0.    37.    42.    18.     0.     0.     6.     1.     0.]
 [    0.     0.    14.    40.    11.     0.  2045.     1.     1.     0.]
 [    0.     0.    46.    25.     6.     0.    10.   299.     3.     0.]
 [    0.     0.    59.    31.    10.     0.    16.    37.   134.     0.]
 [    0.     0.     6.    15.     3.     0.    13.    31.     6.   748.]]
auc evaluation
0.328503694905
-00000000000000000000 smaato
confusion matrix
[[   3772.     694.   49434.     342.     256.       0.       0.       0.     0.       0.]
 [    479.    3895.    8087.    4148.   19692.       0.       3.      53.     0.       0.]
 [      0.    1967.   30094.    3162.    7930.       0.       0.       0.     0.       0.]
 [      0.     163.     545.   18751.     630.       0.       0.       0.     0.       0.]
 [    185.    3776.   21700.   24723.  108685.    2638.       0.       0.     0.       0.]
 [     10.      33.       4.      79.     285.     221.       0.       0.     0.       0.]
 [      0.      69.       1.       0.     297.       0.      42.       0.     0.       0.]
 [      0.     683.       0.       0.       0.       0.       0.     218.     0.       0.]
 [      0.     106.       0.       7.      14.       0.       0.       0.     199.       0.]
 [      0.     110.       0.      10.       2.       0.       0.       0.     0.      16.]]
auc evaluation
0.6849709286
-00000000000000000000 tapsense
confusion matrix
[[ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]]



-------------------------youku
(550, 600) 83548 [     0.  41822.      0.  14581.    122.      0.      0.      0.   1531.  0.      0.      0.]
(250, 300) 70195 [     0.  68413.      0.      0.    283.      0.      0.      0.     67.  0.      0.      0.]
(650, 700) 21603 [     0.   5042.      0.  14587.     60.      0.      0.      0.     99.  0.      0.      0.]
(600, 650) 15063 [     0.      0.      0.  15063.      0.      0.      0.      0.      0.  0.      0.      0.]
(300, 350) 11802 [     0.  10862.      0.      0.    346.      0.      0.      0.     36.  0.      0.      0.]
(800, 850) 11517 [    0.  9201.     0.   266.    88.     0.     0.     0.   157.     0.  0.     0.]
(700, 750) 1386 [    0.     0.     0.  1386.     0.     0.     0.     0.     0.     0.  0.     0.]
(750, 800) 1066 [    0.     0.     0.  1066.     0.     0.     0.     0.     0.     0.  0.     0.]
(500, 550) 751 [   0.  162.    0.  500.    0.    0.    0.    0.    3.    0.    0.    0.]
(1400, 1450) 306 [   0.    0.    0.  306.    0.    0.    0.    0.    0.    0.    0.    0.]
(900, 950) 135 [   0.    0.    0.  135.    0.    0.    0.    0.    0.    0.    0.    0.]
(850, 900) 117 [   0.    0.    0.  117.    0.    0.    0.    0.    0.    0.    0.    0.]
------ total evalution 
0.400970958084
------ seperate evalution 
(500, 550) 751 class separate auc 0.658813115229
(550, 600) 83548 class separate auc 0.546408174144
(600, 650) 15063 class separate auc 0.932157621614
(650, 700) 21603 class separate auc 0.79989001789
(700, 750) 1386 class separate auc 0.847393029421
(750, 800) 1066 class separate auc 0.885332369017
(800, 850) 11517 class separate auc 0.695146824383
(850, 900) 117 class separate auc 0.861979961655
(900, 950) 135 class separate auc 0.854811635743
(950, 1000) 94 class separate auc 0.859821564488
(1000, 1050) 86 class separate auc 0.861244591432
(1050, 1100) 89 class separate auc 0.922139630974
(1100, 1150) 25 class separate auc 0.922722576501
(1150, 1200) 27 class separate auc 0.855012866313
(1200, 1250) 75 class separate auc 0.96098097161
(1250, 1300) 39 class separate auc 0.97995055224
(1300, 1350) 35 class separate auc 0.984096754319
(1350, 1400) 21 class separate auc 0.981804841731
(1400, 1450) 306 class separate auc 0.95632620885
(250, 300) 70195 class separate auc 0.854072219126
(300, 350) 11802 class separate auc 0.771388383793
(400, 450) 15 class separate auc 0.663916261431
weighted_auc 0.723017904378


